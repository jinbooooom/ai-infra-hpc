## [大模型参数量和显存的换算关系](https://www.zhihu.com/question/612046818/answer/3438795176)

### **1B参数对应多少G显存？**

B和G都是十亿（1000M或1024M）的意思，M是100万的意思，平时说模型参数有**x**B就是说有**x**十亿个参数，平时说显存有多少G/M是说有多少G/M个**字节**（byte），1个字节=8比特（bit），那么，1B模型参数对应多少G内存和参数的精度有关，如果是全精度训练（fp32），一个参数对应32比特，也就是4个字节，参数换算到显存的时候要乘4，也就是1B模型参数对应4G显存，如果是fp16或者bf16就是乘2，1B模型参数对应2G显存。

### 有哪几部分显存开销，他们所占显存分别是参数的多少倍？

除了模型参数本身外，训练时的显存开销还有这几个部分：

- 梯度：一个参数对应一个梯度值，所以梯度所占显存是参数的1倍
- 优化器状态：取决于优化器的具体类型，如果是裸SGD就不需要额外显存开销，如果是带一阶动量（momentum）的SGD就是1倍，如果是Adam的话就要在momentum的基础上加上二阶动量，优化器状态所占显存就是参数的2倍。

小结：假设我们全参数微调训练一个参数量为1B的大模型，优化器为Adam，精度为fp32，忽略数据和hidden states部分的显存占用，那么显存占用为：参数的4G+梯度的4G+优化器状态的8G，共16G。如果是bf16精度训练则要减半，就是8G。如果是混合精度训练则根据各部分的精度调整计算过程。







